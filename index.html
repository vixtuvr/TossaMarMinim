<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <title>Android - IPhone Dev</title>

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/nunjucks/2.3.0/nunjucks.min.js"></script>
    <script type="text/javascript" src="https://aframe.io/releases/0.4.0/aframe.min.js"></script>

    <!-- <script src="../../stereo/examples/build.js"></script>-->


    <!-- <script src="../../lib/vixtuvrEngine.js"></script>-->

    <script type="text/javascript" src="../../lib/miniCore.min.js"></script>

    <script type="text/javascript" src="../../lib/kframe.min.js"></script>

    <script type="text/javascript" src="../../components/set-video2.min.js"></script>

    <script type="text/javascript" src="../../components/change-scene2.min.js"></script>

    <script type="text/javascript" src="../../components/aframe-stereo-component.min.js"></script>

    <!-- CSS -->
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Raleway:400,300,100,600">
    <link rel="stylesheet" href="../../normalize.css">
    <link rel="stylesheet" href="../../skeleton.css">


    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="">
    <!--apple-touch-icon-precomposed.png-->
    <link rel="shortcut icon" href="">
    <!-- favicon.ico -->
    <script type="text/javascript">
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-90430248-1', 'auto');
        ga('send', 'pageview');

    </script>
</head>

<body>
<div id="header">
    <div id="headerContent">
        <button id="play-button">Begin Your Experience</button>
        <b id="label-dev">Developer Version</b>
    </div>
</div>


<a-scene class="fullscreen" canvas="" debug="true" stats="true"
         inspector="url: https://aframe.io/releases/0.3.0/aframe-inspector.min.js"
         keyboard-shortcuts="" screenshot="" vr-mode-ui="">

<!--
******************************************************************************************************************************************************************************************
    ASSETS
/*****************************************************************************************************************************************************************************************
-->
<a-assets timeout="3000">

    <audio id="click-sound" src="../../audio/MenuSelect.ogg"></audio>

    <img id="test_img" crossorigin="anonymous" src="../../img/test.png">

    <!-- MARKERS -->

    <img id="TossaLandscapeThumb" crossorigin="anonymous" src="../../img/TossaLandscapeThumb.png">
    <img id="TossaGhoticChurchMainThumb" crossorigin="anonymous" src="../../img/TossaGhoticChurchMainThumb.png">
    <img id="SofiaRestaurantThumb" crossorigin="anonymous" src="../../img/SofiaRestaurantThumb.png">
    <img id="SofiaChillOutThumb" crossorigin="anonymous" src="../../img/SofiaChillOutThumb.png">
    <img id="CookingMuseumIndoorThumb" crossorigin="anonymous" src="../../img/CookingMuseumIndoorThumb.png">
    <img id="DianaChimneyRoomThumb" crossorigin="anonymous" src="../../img/DianaChimneyRoomThumb.png">
    <img id="TossaOctopussyChefMarker" crossorigin="anonymous" src="../../img/TossaOctopussyChefMarker.png">
    <img id="texturechecker" crossorigin="anonymous" src="../../img/test.png">

    <!-- VIDEOS -->

    <video id="other360" loop="true" src="../../videos/tossamar/FortressTossaOne.mp4" webkit-playsinline
           controls autobuffer preload="metadata|auto">
    </video>

    <!--NUNJUCKS TEMPLATES-->

    <script id="linkTemplate" type="text/nunjucks">
                     <a-entity class="link" rotation="{{rotation}}">
                        <a-curvedimage id="{{first}}"  material="shader: flat; src: {{ thumb }}"
                            radius="5.7" theta-length="34" height=".85" rotation="{{rotchild}}" position="{{position}}"
                            scale=".4 .4 .4"  opacity=".8"
                            event-set__1="_event: mousedown; scale: 0.4 0.4 0.4"
                            event-set__2="_event: mouseup; scale: 0.41 0.41 0.41"
                            event-set__3="_event: mouseenter; scale: 0.41 0.41 0.41"
                            event-set__4="_event: mouseleave; scale: 0.4 0.4 0.4"

                            set-video="on: click; target: #videosphere; src: {{ src }}"

                            sound="on: click; src: #click-sound"
                            >
                            <a-animation attribute="rotation" from="0 0 0" to="0 -360 0" begin="0" dur="160000" repeat="infinite" easing="linear"></a-animation>
                     </a-curvedimage>
                    </a-entity>

    </script>

    <script id="linkButtons" type="text/nunjucks">
                     <a-entity class="link" rotation="{{rotation}}">
                        <a-curvedimage id="{{first}}"  material="shader: flat; src: {{ thumb }}"
                            radius="5.7" theta-length="10" height=".85" rotation="{{rotchild}}" position="{{position}}"
                            scale=".4 .4 .4"  opacity=".8"
                            event-set__1="_event: mousedown; scale: 0.4 0.4 0.4"
                            event-set__2="_event: mouseup; scale: 0.41 0.41 0.41"
                            event-set__3="_event: mouseenter; scale: 0.41 0.41 0.41"
                            event-set__4="_event: mouseleave; scale: 0.4 0.4 0.4"

                            set-video="on: click; target: #videosphere; src: {{ src }}"

                            sound="on: click; src: #click-sound"
                            >
                     </a-curvedimage>
                    </a-entity>

    </script>

    <script id="linkButtonsChangeScene" type="text/nunjucks">
                     <a-entity class="link" rotation="{{rotation}}">
                        <a-curvedimage id="{{first}}"  material="shader: flat; src: {{ thumb }}"
                            radius="5.7" theta-length="10" height=".85" rotation="{{rotchild}}" position="{{position}}"
                            scale=".4 .4 .4"  opacity=".8"
                            event-set__1="_event: mousedown; scale: 0.4 0.4 0.4"
                            event-set__2="_event: mouseup; scale: 0.41 0.41 0.41"
                            event-set__3="_event: mouseenter; scale: 0.41 0.41 0.41"
                            event-set__4="_event: mouseleave; scale: 0.4 0.4 0.4"
                            change-scene="on : click; scene: {{scene}}"


                            set-video="on: click; target: {{target}}; src: {{ src }}"
                            sound="on: click; src: #click-sound"
                            >
                            <a-animation attribute="rotation" from="0 0 0" to="0 -360 0" begin="0" dur="100000" repeat="infinite" easing="linear"></a-animation>
                     </a-curvedimage>
                    </a-entity>

    </script>


    <script id="linkButtonsChangeSceneNoRotation" type="text/nunjucks">
                     <a-entity class="link">
                        <a-plane material="shader: flat; src: {{ thumb }}"
                            height="1" width = "1"
                            scale="1.0 1.0 1.0"  opacity="0.8"
                            event-set__1="_event: mousedown; scale: 1.0 1.0 1.0"
                            event-set__2="_event: mouseup; scale: 1.2 1.2 1.2"
                            event-set__3="_event: mouseenter; scale: 1.2 1.2 1.2"
                            event-set__4="_event: mouseleave; scale: 1.0 1.0 1.0"
                            change-scene="on : click; scene: {{scene}}"


                            set-video="on: click; target: {{target}}; src: {{ src }}"
                            sound="on: click; src: #click-sound"
                            >

                     </a-curvedimage>
                    </a-entity>

    </script>

</a-assets>
<!--
******************************************************************************************************************************************************************************************
    END ASSETS
/*****************************************************************************************************************************************************************************************
-->

<!--
******************************************************************************************************************************************************************************************
         PERSISTENT BUTTONS
/*****************************************************************************************************************************************************************************************
-->

<!-- If the audio of the buttons is emitted from the button, they must be near the listener to be audible-->

<a-entity id="persistentbuttons" position="0 0.75 0"> <!-- layout="layout: line; margin: 1.5" -->
    <!-- 5 angles 0, -72, -144, -216, -288 -->
    <a-entity template="src: #linkButtonsChangeScene" id="btn1" data-target="#videosphere" data-src="../../videos/tossamar/TossaMarLandscape.mp4" data-thumb="#TossaLandscapeThumb"
              data-first="maphallbutton1" data-rotation="0 0 0" data-scene="1">
    </a-entity>

    <a-entity template="src: #linkButtonsChangeScene" id="btn2" data-target="#videosphere" data-src="../../videos/tossamar/TossaMarGhoticChurchMain.mp4" data-thumb="#TossaGhoticChurchMainThumb"
              data-first="maphallbutton2" data-rotation="0 -72 0" data-scene="2">
    </a-entity>

    <a-entity template="src: #linkButtonsChangeScene" id="btn3" data-target="#videosphere" data-src="../../videos/tossamar/Granados360.mp4" data-thumb="#SofiaRestaurantThumb"
              data-first="maphallbutton3" data-rotation="0 -144 0" data-scene="3">
    </a-entity>

    <a-entity template="src: #linkButtonsChangeScene" id="btn4" data-target="#videosphere" data-src="../../videos/tossamar/GranadosTerraceOne.mp4" data-thumb="#SofiaChillOutThumb"
              data-first="maphallbutton4" data-rotation="0 -216 0" data-scene="4">
    </a-entity>

    <a-entity template="src: #linkButtonsChangeScene" id="btn5" data-target="#videosphere" data-src="../../videos/tossamar/DianaChimney.mp4" data-thumb="#DianaChimneyRoomThumb"
              data-first="maphallbutton5" data-rotation="0 -288 0" data-scene="5">
    </a-entity>

</a-entity>


<a-entity id="Scene_one_parent" active visible position="0 0 0">

    <a-videosphere id="videosphere" rotation="0 -110 0" active visible src="#other360"
                   autoplay="false" data-set-image-fade-setup="true" animation__fade=""></a-videosphere>
</a-entity>

<a-entity id="Scene_two_parent" active visible position="0 0 0">

    <a-videosphere id="videosphere" rotation="0 -110 0" active visible src="#other360"
                   autoplay="false" data-set-image-fade-setup="true" animation__fade=""></a-videosphere>
</a-entity>

<a-entity id="Scene_three_parent" active visible position="0 0 0">

    <a-videosphere id="videosphere" rotation="0 -110 0" active visible src="#other360"
                   autoplay="false" data-set-image-fade-setup="true" animation__fade=""></a-videosphere>

    <!--
    ******************************************************************************************************************************************************************************************
            NON PERSISTENT BUTTONS
    /*****************************************************************************************************************************************************************************************
    -->

    <!-- If the audio of the buttons is in the button, they must be near the listener to be audible-->

    <a-entity id="provisional_buttons_scene_three" position="0.75 2.25 -2.0" rotation="0.0 -15.0 0.0" scale="0.5 0.5 0.5" active visible>

        <a-entity template="src: #linkButtonsChangeSceneNoRotation" id="buttonthreeone" data-thumb="#TossaOctopussyChefMarker" data-target="#videosphere"
                  data-src="../../videos/tossamar/GranadosOctopusssySlaughter360.mp4">
        </a-entity>
    </a-entity>

    <!--
    ******************************************************************************************************************************************************************************************
        END NON PERSISTENT BUTTONS
    /*****************************************************************************************************************************************************************************************
    -->

</a-entity>

<a-entity id="Scene_four_parent" active visible position="0 0 0">

    <a-videosphere id="videosphere" rotation="0 -110 0" active visible src="#other360"
                   autoplay="false" data-set-image-fade-setup="true" animation__fade=""></a-videosphere>
</a-entity>

<a-entity id="Scene_five_parent" active visible position="0 0 0">

    <a-videosphere id="videosphere" rotation="0 -110 0" active visible src="#other360"
                   autoplay="false" data-set-image-fade-setup="true" animation__fade=""></a-videosphere>

    <!--
    ******************************************************************************************************************************************************************************************
            NON PERSISTENT BUTTONS
    /*****************************************************************************************************************************************************************************************
    -->

    <!-- If the audio of the buttons is in the button, they must be near the listener to be audible-->

    <a-entity id="provisional_buttons_scene_five" position="0.75 2.25 -2.0" rotation="0.0 -15.0 0.0" scale="0.5 0.5 0.5" active visible>

        <a-entity template="src: #linkButtonsChangeSceneNoRotation" id="buttonfiveone" data-thumb="#TossaOctopussyChefMarker" data-target="#videosphere"
                  data-src="../../videos/tossamar/DianaSolarium.mp4">
        </a-entity>
    </a-entity>

    <!--
    ******************************************************************************************************************************************************************************************
        END NON PERSISTENT BUTTONS
    /*****************************************************************************************************************************************************************************************
    -->

</a-entity>

<a-entity id="Scene_six_parent" active visible position="0 0 0">

    <a-videosphere id="videosphere" rotation="0 -110 0" active visible src="#other360"
                   autoplay="false" data-set-image-fade-setup="true" animation__fade=""></a-videosphere>
</a-entity>

    <!--
    ******************************************************************************************************************************************************************************************
            CAMERA
    /*****************************************************************************************************************************************************************************************
    -->
    <a-camera camera active="true" visible="true" position="0 0.5 0" id="player1" collider-check>
        <a-cursor active visible id="cursor1" color="orange" event-set__1="_event:mouseenter; color: springgreen"
                  event-set__2="_event: mouseleave; color: orange" raycaster="objects: .link" material="" cursor=""
                  geometry="" position="" rotation="" scale color="springgreen">
            <!--
            <a-animation begin="mouseenter" easing="ease-in" attribute="scale"
                         fill="backwards" from="1 1 1" to="0.1 0.1 0.1" dur="1500"></a-animation>
            <a-animation begin="mouseleave" easing="ease-in" attribute="scale"
                         fill="backwards" from="0.1 0.1 0.1" to=" 1 1 1"></a-animation>

            <a-animation begin="click" easing="ease-in" attribute="scale"
                         fill="forwards" from="1 1 1" to="0.1 0.1 0.1"></a-animation>

            <a-animation begin="fusing" easing="ease-in" attribute="scale"
                         fill="forwards" from="1 1 1" to="0.1 0.1 0.1"></a-animation>
            -->
        </a-cursor>
    </a-camera>
    <!--
    ******************************************************************************************************************************************************************************************
            END CAMERA
    /*****************************************************************************************************************************************************************************************
    -->
</a-entity>

</a-scene>


<div id="footer">
    <div id="footerContent">

    </div>
</div>


<script type="text/javascript">

    var scene = document.querySelector("a-scene");
    var videos = document.getElementsByTagName("video");

    console.log("is mobile: " + checkUserAgent() + " " + TYPE_AGENT);

    if (scene.hasLoaded) {
        console.log("LOADED");
        initCore();
        //myGameObjectVisible(document.querySelector("#tempvideosphere"),false);

    } else {
        console.log("not loaded");
        document.querySelector("#play-button").style.display = "none";
        scene.addEventListener('loaded', initCore);

        //setVisibleComponent("tempvideosphere");
    }

    initScene = function () {
        //custom init
        changeTo(GameState.ONE);
        setVisibleComponent("Scene_one_parent", true);
        setVisibleComponent("Scene_two_parent", false);
        setVisibleComponent("Scene_three_parent", false);
        setVisibleComponent("Scene_four_parent", false);
        setVisibleComponent("Scene_five_parent", false);
        setVisibleComponent("Scene_six_parent", false);

        scaleComponent("Scene_two_parent", 0.0, 0.0, 0.0);
        scaleComponent("Scene_three_parent", 0.0, 0.0, 0.0);
        scaleComponent("Scene_four_parent", 0.0, 0.0, 0.0);
        scaleComponent("Scene_five_parent", 0.0, 0.0, 0.0);
        scaleComponent("Scene_six_parent", 0.0, 0.0, 0.0);

    };

</script>

</body>
</html>